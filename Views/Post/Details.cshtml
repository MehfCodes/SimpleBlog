@model SimpleBlog.Models.Domain.Post
@{
    ViewData["Title"] = "Post Details";
}
<div class="container my-5">

    <div class="card shadow-lg rounded-4 border-0">
        <div class="card-body p-5">
            <!-- Post Header -->
            <p class="card-title display-6 fw-bold mb-5 text-xl">@Model.Title</p>
            <p class="text-muted mb-3">
                <b>Written by:</b> @(Model.Author?.UserName ?? "Unknown")
            </p>
            <p class="text-muted mb-3">
                <b>Created at:</b> @Model.CreatedAt.ToString("yyyy-MM-dd")
            </p>
            <hr />

            <!-- Post Content -->
            <div class="mb-4 content-body" style="line-height: 1.8;">
                @Html.Raw(Model.Content)
            </div>

    
    <div class="d-flex align-items-center gap-3">
        <form asp-action="ToggleLike" asp-route-postId="@Model.Id" method="post">
            <button type="submit" class="btn btn-outline-danger">
                ❤️ Like (@Model.Likes.Count)
            </button>
        </form>
    </div>

    <hr />

    <h4>Comments</h4>

    @if (User.Identity!.IsAuthenticated)
    {
        <form asp-action="AddComment" asp-route-postId="@Model.Id" method="post">
            @Html.AntiForgeryToken()
            <div class="mb-3">
                <textarea name="content" class="form-control" placeholder="Write a comment..." rows="3"></textarea>
            </div>
            <div class="d-flex justify-content-between align-items-center mb-3 mt-5">
                <a onclick="history.back()"  class="btn btn-dark">Back to list</a>
                <button type="submit" class="btn btn-primary">Add Comment</button>
            </div>
        </form>
    }

    <br/>
    <br/>
    <ul class="hover-card list-unstyled mt-3">
        @foreach (var comment in Model.Comments.OrderByDescending(c => c.CreatedAt))
        {
            <li class="border rounded p-2 mb-2">
                <b class="m-3 p-1">@comment.User!.UserName</b>
                <small class="text-muted">(@comment.CreatedAt.ToLocalTime())</small>
                <p class="m-2" style="text-indent: 2em">@comment.Content</p>
            </li>
        }
    </ul>
</div>

<style>
    .content-body * {
        line-height: 2 !important;
        font-family: serif !important;
        font-size: 20px !important;
        color: black !important;
    }
    /* Hover effect on comment cards */
    .hover-card:hover {
        transform: translateY(-4px);
        transition: all 0.2s ease-in-out;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    /* Smooth card transition */
    .card-body {
        transition: all 0.3s ease-in-out;
    }
</style>